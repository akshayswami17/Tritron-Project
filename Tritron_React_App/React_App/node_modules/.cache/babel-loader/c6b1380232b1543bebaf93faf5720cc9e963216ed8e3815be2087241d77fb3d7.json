{"ast":null,"code":"//01-06-2024\nimport React,{useReducer,useState}from'react';import{useNavigate}from'react-router-dom';import{useDispatch}from'react-redux';import{login}from'./slice';import'../CSS Files/LoginComp.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";export default function LoginComp(){const initialState={username:\"\",password:\"\"};// Example login function\nconst handleLogin=userId=>{// Assuming userId is obtained after a successful login\nlocalStorage.setItem('userId',userId);};const reducer=(state,action)=>{switch(action.type){case'update':return{...state,[action.field]:action.value};case'reset':return initialState;default:return state;}};const[formData,dispatch]=useReducer(reducer,initialState);const[errorMsg,setErrorMsg]=useState(\"\");const navigate=useNavigate();const reduxDispatch=useDispatch();const handleChange=(e,field)=>{dispatch({type:'update',field,value:e.target.value});};const handleSubmit=async e=>{e.preventDefault();try{const response=await fetch(\"http://localhost:8080/checkUser\",{method:'POST',headers:{'content-type':'application/json'},body:JSON.stringify({username:formData.username,password:formData.password})});if(!response.ok){throw new Error(\"Server Error\");}const data=await response.json();if(data===null){setErrorMsg(\"Wrong Username/Password\");}else{reduxDispatch(login(data));localStorage.setItem('userId',data.uid);// Dispatch login action with user data\nif(!data.activation_status){alert(\"Request has not been approved\");}else{switch(data.role.role_id){case 1:navigate(\"/admin_home\");break;case 2:navigate(\"/consumer_home\");break;case 3:navigate(\"/seller_home\");break;default:break;}}}}catch(error){console.error(\"Error:\",error);alert(\"Error: \"+error.message);}};const handleClear=()=>{dispatch({type:'reset'});setErrorMsg(\"\");};return/*#__PURE__*/_jsxs(\"div\",{className:\"login-container\",children:[/*#__PURE__*/_jsx(\"h1\",{className:\"login-heading\",children:\"LOGIN\"}),/*#__PURE__*/_jsxs(\"form\",{className:\"my-4\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 row\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"username\",className:\"col-sm-3 col-form-label\",children:\"Username:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control form-control-sm\",id:\"username\",name:\"username\",value:formData.username,onChange:e=>handleChange(e,'username')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"mb-3 row\",children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"password\",className:\"col-sm-3 col-form-label\",children:\"Password:\"}),/*#__PURE__*/_jsx(\"div\",{className:\"col-sm-8\",children:/*#__PURE__*/_jsx(\"input\",{type:\"password\",className:\"form-control form-control-sm\",id:\"password\",name:\"password\",value:formData.password,onChange:e=>handleChange(e,'password')})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-row\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-outline-primary me-2\",children:\"Submit\"}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"btn btn-outline-danger\",onClick:handleClear,children:\"Clear\"})]})]}),errorMsg&&/*#__PURE__*/_jsx(\"p\",{className:\"error-message\",children:errorMsg})]});}","map":{"version":3,"names":["React","useReducer","useState","useNavigate","useDispatch","login","jsx","_jsx","jsxs","_jsxs","LoginComp","initialState","username","password","handleLogin","userId","localStorage","setItem","reducer","state","action","type","field","value","formData","dispatch","errorMsg","setErrorMsg","navigate","reduxDispatch","handleChange","e","target","handleSubmit","preventDefault","response","fetch","method","headers","body","JSON","stringify","ok","Error","data","json","uid","activation_status","alert","role","role_id","error","console","message","handleClear","className","children","onSubmit","htmlFor","id","name","onChange","onClick"],"sources":["A:/Tritron Project/Tritron_React_App/React_App/src/components/LoginComp.js"],"sourcesContent":["\r\n\r\n\r\n//01-06-2024\r\n\r\nimport React, { useReducer, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { useDispatch } from 'react-redux';\r\nimport { login } from './slice';\r\nimport '../CSS Files/LoginComp.css';\r\n\r\nexport default function LoginComp() {\r\n  const initialState = {\r\n    username: \"\",\r\n    password: \"\"\r\n  };\r\n  // Example login function\r\nconst handleLogin = (userId) => {\r\n  // Assuming userId is obtained after a successful login\r\n  localStorage.setItem('userId', userId);\r\n};\r\n\r\n\r\n  const reducer = (state, action) => {\r\n    switch (action.type) {\r\n      case 'update':\r\n        return { ...state, [action.field]: action.value };\r\n      case 'reset':\r\n        return initialState;\r\n      default:\r\n        return state;\r\n    }\r\n  };\r\n\r\n  const [formData, dispatch] = useReducer(reducer, initialState);\r\n  const [errorMsg, setErrorMsg] = useState(\"\");\r\n  const navigate = useNavigate();\r\n  const reduxDispatch = useDispatch();\r\n\r\n  const handleChange = (e, field) => {\r\n    dispatch({ type: 'update', field, value: e.target.value });\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    try {\r\n      const response = await fetch(\"http://localhost:8080/checkUser\", {\r\n        method: 'POST',\r\n        headers: { 'content-type': 'application/json' },\r\n        body: JSON.stringify({\r\n          username: formData.username,\r\n          password: formData.password\r\n        })\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error(\"Server Error\");\r\n      }\r\n\r\n      const data = await response.json();\r\n      if (data === null) {\r\n        setErrorMsg(\"Wrong Username/Password\");\r\n      } else {\r\n        reduxDispatch(login(data));\r\n        localStorage.setItem('userId', data.uid); // Dispatch login action with user data\r\n        if (!data.activation_status) {\r\n          alert(\"Request has not been approved\");\r\n        } else {\r\n          switch (data.role.role_id) {\r\n            case 1:\r\n              navigate(\"/admin_home\");\r\n              break;\r\n            case 2:\r\n              navigate(\"/consumer_home\");\r\n              break;\r\n            case 3:\r\n              navigate(\"/seller_home\");\r\n              break;\r\n            default:\r\n              break;\r\n          }\r\n        }\r\n      }\r\n    } catch (error) {\r\n      console.error(\"Error:\", error);\r\n      alert(\"Error: \" + error.message);\r\n    }\r\n  };\r\n\r\n  const handleClear = () => {\r\n    dispatch({ type: 'reset' });\r\n    setErrorMsg(\"\");\r\n  };\r\n\r\n  return (\r\n    <div className='login-container'>\r\n      <h1 className='login-heading'>LOGIN</h1>\r\n      <form className=\"my-4\" onSubmit={handleSubmit}>\r\n        <div className=\"mb-3 row\">\r\n          <label htmlFor=\"username\" className=\"col-sm-3 col-form-label\">\r\n            Username:\r\n          </label>\r\n          <div className=\"col-sm-8\">\r\n            <input\r\n              type=\"text\"\r\n              className=\"form-control form-control-sm\"\r\n              id=\"username\"\r\n              name=\"username\"\r\n              value={formData.username}\r\n              onChange={(e) => handleChange(e, 'username')}\r\n            />\r\n          </div>\r\n        </div>\r\n        <div className=\"mb-3 row\">\r\n          <label htmlFor=\"password\" className=\"col-sm-3 col-form-label\">\r\n            Password:\r\n          </label>\r\n          <div className=\"col-sm-8\">\r\n            <input\r\n              type=\"password\"\r\n              className=\"form-control form-control-sm\"\r\n              id=\"password\"\r\n              name=\"password\"\r\n              value={formData.password}\r\n              onChange={(e) => handleChange(e, 'password')}\r\n            />\r\n          </div>\r\n        </div>\r\n        \r\n        <div className=\"form-row\">\r\n          <button type=\"submit\" className=\"btn btn-outline-primary me-2\">Submit</button>\r\n          <button type=\"button\" className=\"btn btn-outline-danger\" onClick={handleClear}>Clear</button>\r\n        </div>\r\n      </form>\r\n      {errorMsg && <p className=\"error-message\">{errorMsg}</p>}\r\n    </div>\r\n  );\r\n}\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}